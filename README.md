# Personalized and context-specific climate resilience and adaptation with large language model

[![Arxiv](https://img.shields.io/badge/ArXiv-Read_Our_Paper-B31B1B)](https://arxiv.org/pdf/2402.07877) 

ðŸš€ The preliminary version of this work has been accepted at the [NeurIPS 2024 Workshop on Tackling Climate Change with Machine Learning](https://www.climatechange.ai/events/neurips2024). Weâ€™re thrilled to share the [preprint](https://arxiv.org/pdf/2402.07877) â€” check it out!

## Pre-requisites
We use Python 3.11.6 and [Poetry](https://python-poetry.org/) to manage dependencies. 

We recommend using [pyenv](https://github.com/pyenv/pyenv) to manage your python versions. To switch to Python 3.11.6, run 
```
pyenv install 3.11.6
pyenv local 3.11.6
```

To After pulling from github, in your ``callm`` folder, do the following to install the dependencies:
```
poetry build
poetry install # install dependencies
poetry shell # make a virtual environment
```

If you would like to exit the virtual environment, run
```
exit # exit shell
```

Lastly, create a ``.env`` file in the root directory of the project and add the following:
```
OPENAI_API_KEY=<your openai api key>
model=<your model name  # e.g. gpt-4-1106-preview>
```
Please check [OpenAI Model Pricing](https://openai.com/pricing) before choosing a model.

## Data

All data are available under the ``data`` folder. You can download all the data from this [Box Link](https://anl.box.com/s/wm888zovyapyou1txae7g75ghpc7sxre).

The data provided above are retrieved from the following sources:

- The Fire Weather Index (FWI) projections from ClimRR are available for download at [https://anl.app.box.com/s/hmkkgkrkzxxocfe9kpgrzk2gfc4gizp8](https://anl.app.box.com/s/hmkkgkrkzxxocfe9kpgrzk2gfc4gizp8). Make sure to include `GridCellsShapefile` as well as `FireWeatherIndex_Wildfire.csv`.
- Wildland Fire Incident Locations data can be accessed at [https://data-nifc.opendata.arcgis.com/datasets/nifc::wildland-fire-incident-locations/about](https://data-nifc.opendata.arcgis.com/datasets/nifc::wildland-fire-incident-locations/about). To run WildfireGPT, we pruned the data to include these four columns: `lon`, `lat`, `year`, `month` and renamed the file to `data/Wildland_Fire_Incident_Locations_pruned.csv`.
- The North American Tree-Ring Fire Scar Synthesis (NAFSS) dataset can be downloaded from [https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=noaa-fire-34853](https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=noaa-fire-34853). 
- Census ACS5 data is accessible via the Python API package at [https://github.com/Census-ACS/census](https://github.com/Census-ACS/census). 
- The scientific literature data developed by CIACC can be downloaded from [https://anl.box.com/s/b4m2mnt5wa4z9l71qioz05cb5qpduj2j](https://anl.box.com/s/b4m2mnt5wa4z9l71qioz05cb5qpduj2j). To create the embedding and index, run 

```
python src/literature/embedding.py
python src/literature/index.py
```

## Run WildfireGPT

All data are available under the ``data`` folder. You can download all the data from this [Box Link](https://anl.box.com/s/wm888zovyapyou1txae7g75ghpc7sxre).

We use [Streamlit](https://streamlit.io) to create a web app. To run the web app, run
```
streamlit run src/wildfireChat.py
```

## Evaluate the Case Study Results

To evaluate the case study results, run
```
python src/evaluation/eval_offline.py
```
This will generate the GPT-as-Judge evaluation results under each case study folder. To compute the domain expert evaluation scores,
```
python src/evaluation/extract_expert_score.py
```

## Comparative Analysis

`Comparison.md` summarizes contains all results when we compare WildfireGPT against [ChatClimate](https://www.chatclimate.ai) and [PerplexityAI](https://www.perplexity.ai). 

`ablation_study.ipynb` investigates the impact of different levels of user profile specificity on the response generated by WildfireGPT.

## Transcript of Each Case Study

You can find the transcripts of each case study in the `case_study` folder. The transcripts are organized by case study and include the following files:
- `transcript.pdf`: The transcript of the conversation between the user and WildfireGPT.
- `perplexity_{}.pdf`: The transcript of the response generated by PerplexityAI against a provided prompt.
- The response produced by ChatClimate is not included in the case study folder, but you can find them in the `comparison.md` file.
